# Enhanced Evergreen Scanner Configuration
# Copy this file to config.yaml and update with your values

# GitLab Configuration
gitlab:
  url: "https://gitlab.com"
  access_token: "your_gitlab_access_token_here" 
  project_path: "your-username/your-project"
  api_version: 4
  timeout: 60
  retries: 3

# Scanner Configuration
scanner:
  branch_prefix: "evergreen/"
  dockerfile_patterns:
    - "Dockerfile*"
    - "*.dockerfile" 
    - "docker/Dockerfile*"
    - "build/Dockerfile*"
  exclude_patterns:
    - "test/*"
    - "examples/*"
    - "docs/*"
  
  # Registry Configuration
  registries:
    docker_hub:
      enabled: true
      timeout: 30
      retries: 3
      rate_limit_delay: 1.0
    
    # Add support for private registries
    # custom_registry:
    #   enabled: false
    #   url: "registry.example.com"
    #   username: "your_username"
    #   password: "your_password"
    #   timeout: 30

# Scheduling Configuration
scheduler:
  enabled: true
  interval_hours: 6  # Check every 6 hours
  cron_expression: "0 */6 * * *"  # Alternative cron format
  timezone: "UTC"
  
  # Run immediately on startup
  run_on_startup: false
  
  # Maximum concurrent scans
  max_concurrent_scans: 3

# Webhook Configuration (for manual triggers)
webhook:
  enabled: false
  host: "0.0.0.0"
  port: 8080
  secret_token: "your_webhook_secret"
  endpoints:
    trigger: "/trigger"
    health: "/health"
    status: "/status"

# Merge Request Configuration  
merge_request:
  auto_merge: false
  remove_source_branch: true
  squash: true
  labels:
    - "evergreen"
    - "dependencies" 
    - "automated"
  assignee: null  # Set to username to auto-assign
  reviewers: []   # List of usernames
  
  # Template configuration
  title_template: "Update {image_name} from {current_version} to {latest_version}"
  description_template: |
    ## Automated Dependency Update

    This merge request updates the Docker image dependency:

    - **Image**: {image_name}
    - **Current Version**: {current_version}
    - **New Version**: {latest_version}
    - **File**: {dockerfile_path}
    - **Registry**: {registry}

    ### Changes
    - Updated base image to latest stable version
    - Automated security and feature updates included

    ### Checklist
    - [ ] Review the changelog for breaking changes
    - [ ] Update any related documentation
    - [ ] Test the changes in a development environment
    - [ ] Verify CI/CD pipeline passes

    ---
    *Generated by Evergreen Scanner v2.0*

# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file:
    enabled: true
    path: "logs/evergreen.log"
    max_bytes: 10485760  # 10MB
    backup_count: 5
  
  # Console logging
  console:
    enabled: true
    colored: true

# Notification Configuration
notifications:
  slack:
    enabled: false
    webhook_url: "https://hooks.slack.com/services/..."
    channel: "#devops"
    username: "Evergreen Scanner"
    
  email:
    enabled: false
    smtp_server: "smtp.gmail.com"
    smtp_port: 587
    username: "your_email@example.com"
    password: "your_app_password"
    recipients:
      - "team@example.com"

# Health Check Configuration
health_check:
  enabled: true
  endpoint: "/health"
  detailed: true  # Include detailed status information
  
# Metrics Configuration (Prometheus compatible)
metrics:
  enabled: false
  port: 9090
  endpoint: "/metrics"
